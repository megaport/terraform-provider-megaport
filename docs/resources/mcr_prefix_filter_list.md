---
# generated by https://github.com/hashicorp/terraform-plugin-docs
page_title: "megaport_mcr_prefix_filter_list Resource - terraform-provider-megaport"
subcategory: ""
description: |-
  MCR Prefix Filter List Resource for the Megaport Terraform Provider. This resource manages individual prefix filter lists for MCR instances, providing better resource management compared to inline prefix_filter_lists.
---

# megaport_mcr_prefix_filter_list (Resource)

MCR Prefix Filter List Resource for the Megaport Terraform Provider. This resource manages individual prefix filter lists for MCR instances, providing better resource management compared to inline prefix_filter_lists.

## Example Usage

```terraform
# Basic IPv4 prefix filter list example
resource "megaport_mcr_prefix_filter_list" "ipv4_example" {
  mcr_id         = "11111111-1111-1111-1111-111111111111" # Replace with your MCR UID
  description    = "IPv4 Prefix Filter List Example"
  address_family = "IPv4"

  entries = [
    {
      action = "permit"
      prefix = "10.0.0.0/8"
      ge     = 16
      le     = 24
    },
    {
      action = "permit"
      prefix = "172.16.0.0/12"
      # ge and le are optional - if not specified, exact match on prefix length
    },
    {
      action = "deny"
      prefix = "192.168.1.0/24"
      ge     = 24
      le     = 32
    }
  ]
}

# IPv6 prefix filter list example
resource "megaport_mcr_prefix_filter_list" "ipv6_example" {
  mcr_id         = "11111111-1111-1111-1111-111111111111" # Replace with your MCR UID
  description    = "IPv6 Prefix Filter List Example"
  address_family = "IPv6"

  entries = [
    {
      action = "permit"
      prefix = "2001:db8::/32"
      ge     = 48
      le     = 64
    },
    {
      action = "deny"
      prefix = "2001:db8:bad::/48"
    }
  ]
}

# Multiple prefix filter lists on the same MCR
resource "megaport_mcr_prefix_filter_list" "inbound_filter" {
  mcr_id         = "11111111-1111-1111-1111-111111111111" # Replace with your MCR UID
  description    = "Inbound Traffic Filter"
  address_family = "IPv4"

  entries = [
    {
      action = "permit"
      prefix = "203.0.113.0/24"
      ge     = 24
      le     = 30
    },
    {
      action = "deny"
      prefix = "0.0.0.0/0"
      le     = 7 # Deny default routes and very broad prefixes
    }
  ]
}

resource "megaport_mcr_prefix_filter_list" "outbound_filter" {
  mcr_id         = "11111111-1111-1111-1111-111111111111" # Replace with your MCR UID
  description    = "Outbound Traffic Filter"
  address_family = "IPv4"

  entries = [
    {
      action = "permit"
      prefix = "10.0.0.0/8"
      ge     = 24
      le     = 32
    },
    {
      action = "permit"
      prefix = "172.16.0.0/12"
      ge     = 24
      le     = 32
    }
  ]
}

# Using with an existing MCR resource
resource "megaport_mcr" "example_mcr" {
  product_name         = "MCR for Prefix Filter Lists"
  port_speed           = 1000
  location_id          = 6
  contract_term_months = 1
}

resource "megaport_mcr_prefix_filter_list" "dynamic_example" {
  mcr_id         = megaport_mcr.example_mcr.product_uid
  description    = "Dynamic MCR Prefix Filter List"
  address_family = "IPv4"

  entries = [
    {
      action = "permit"
      prefix = "198.51.100.0/24"
      ge     = 28
      le     = 32
    }
  ]
}

# Output the prefix filter list ID for reference
output "prefix_filter_list_id" {
  description = "The ID of the created prefix filter list"
  value       = megaport_mcr_prefix_filter_list.ipv4_example.prefix_filter_list_id
}
```

<!-- schema generated by tfplugindocs -->
## Schema

### Required

- `address_family` (String) The IP address standard of the IP network addresses in the prefix filter list. Valid values are 'IPv4' and 'IPv6'.
- `description` (String) Description of the prefix filter list.
- `entries` (Attributes List) Entries in the prefix filter list. Must contain between 1 and 200 entries. (see [below for nested schema](#nestedatt--entries))
- `mcr_id` (String) The UID of the MCR instance this prefix filter list belongs to.

### Read-Only

- `id` (Number) Numeric ID of the prefix filter list.
- `last_updated` (String) Timestamp of when the resource was last updated.

<a id="nestedatt--entries"></a>
### Nested Schema for `entries`

Required:

- `action` (String) The action to take for the network address in the filter list. Valid values are 'permit' and 'deny'.
- `prefix` (String) The network address of the prefix filter list entry in CIDR notation (e.g., '10.0.1.0/24').

Optional:

- `ge` (Number) The minimum starting prefix length to be matched. Valid values are from 0 to 32 (IPv4), or 0 to 128 (IPv6). If not specified, defaults to the prefix length of the network address.
- `le` (Number) The maximum ending prefix length to be matched. Valid values are from 0 to 32 (IPv4), or 0 to 128 (IPv6). Must be greater than or equal to 'ge'. If not specified, defaults to 32 (IPv4) or 128 (IPv6).

## Import

Import is supported using the following syntax:

```shell
#!/bin/bash

# MCR Prefix Filter Lists can be imported using the format: mcr_uid:prefix_list_id
#
# Where:
# - mcr_uid: The UID of the MCR that owns the prefix filter list
# - prefix_list_id: The numeric ID of the prefix filter list (must be positive integer)
#
# You can find these values using the Megaport API or portal:
# 1. MCR UID: Available in MCR details or from terraform state of megaport_mcr resource
# 2. Prefix List ID: Available in MCR prefix filter list details

# Example 1: Import existing prefix filter list
terraform import megaport_mcr_prefix_filter_list.example "11111111-1111-1111-1111-111111111111:123"

# Example 2: Import multiple prefix filter lists from the same MCR
terraform import megaport_mcr_prefix_filter_list.inbound_filter "11111111-1111-1111-1111-111111111111:456"
terraform import megaport_mcr_prefix_filter_list.outbound_filter "11111111-1111-1111-1111-111111111111:789"

# Example 3: Import with descriptive resource names
terraform import megaport_mcr_prefix_filter_list.ipv4_customer_routes "22222222-2222-2222-2222-222222222222:101"
terraform import megaport_mcr_prefix_filter_list.ipv6_customer_routes "22222222-2222-2222-2222-222222222222:102"

# Common troubleshooting:
# - Ensure the MCR UID is correct and the MCR exists
# - Verify the prefix filter list ID exists on the specified MCR
# - Check that the prefix filter list ID is a positive integer
# - Make sure you have appropriate permissions to access the MCR and its prefix filter lists

# To find existing prefix filter lists:
# 1. Use the Megaport Portal to view MCR details
# 2. Use the Megaport API: GET /mcr/{mcrId}/prefixFilterLists
# 3. Check terraform state if the MCR was created with embedded prefix filter lists

echo "Import format: terraform import megaport_mcr_prefix_filter_list.<resource_name> \"<MCR_UID>:<PREFIX_LIST_ID>\""
echo "Replace <resource_name>, <MCR_UID>, and <PREFIX_LIST_ID> with your actual values"
```
